<?xml version="1.0" encoding="UTF-8"?>

<tests xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xsi:noNamespaceSchemaLocation="urn:magento:mftf:Test/etc/testSchema.xsd">
    <test name="SignifydSuccessPostAuthWebhookDoNothingCaseTest" extends="SignifydSuccessPostAuthCaseTest">
        <annotations>
            <features value="Signifyd Post Auth Do Nothing"/>
            <stories value="Pre auth case created successfully"/>
            <title value="Post Auth do nothing positive action"/>
            <description value="Validate post auth do nothing positive action"/>
            <severity value="CRITICAL"/>
            <group value="checkout"/>
        </annotations>
        <before>
            <!-- Set Signifyd positive action-->
            <magentoCLI command="config:set {{GuaranteePositiveAction.path}} {{GuaranteePositiveAction.nothing}}" stepKey="setPositiveAction"/>
        </before>

        <!-- Go to the Signifyd configuration and make sure the page is available -->
        <actionGroup ref="AdminOpenStoreConfigSignifydPageActionGroup" stepKey="goToSignifydConfigPage" before="customerLogin"/>
        <wait stepKey="waitClickWebhookButton" time="10" before="customerLogin"/>

        <!--Click Webhook button-->
        <click selector="{{AdminSignifydSection.signifydWebhookButton}}" stepKey="clickRegisterWebhook" before="customerLogin"/>
        <waitForPageLoad stepKey="waitForWebhookButton"/>

        <!-- Assert that the webhoook was successfully registered -->
        <see selector="{{AdminSignifydSection.signifydWebhookSuccessMessage}}" userInput="The webhook was registred successfully." stepKey="seeWebhookRegistered" before="customerLogin"/>
    </test>
</tests>